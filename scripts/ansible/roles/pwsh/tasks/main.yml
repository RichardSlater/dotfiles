---
- name: Install libicu72
  become: true
  block:
    - name: Add libicu72
      apt:
        deb: "http://security.debian.org/debian-security/pool/updates/main/i/icu/libicu72_72.1-3+deb12u1_amd64.deb"
  when:
    - ansible_facts['os_family'] == "Debian"
    - ansible_facts['distribution_version'] is version('13.0', '>=') 

- name: Install PowerShell (pwsh)
  become: true
  block:
    - name: Install PowerShell on Debian 12
      apt:
        deb: "https://github.com/PowerShell/PowerShell/releases/download/v{{ pwsh_target_version }}/powershell_{{ pwsh_target_version }}-1.deb_amd64.deb"

- name: Verify PowerShell Installation
  command: "pwsh --version"
  register: pwsh_version
  changed_when: false

- name: Show Installed PowerShell Version
  debug:
    msg: "Installed PowerShell Version: {{ pwsh_version.stdout }}"
